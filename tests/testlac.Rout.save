
R version 3.4.1 (2017-06-30) -- "Single Candle"
Copyright (C) 2017 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> suppressPackageStartupMessages(library(stationaryracsinference))
> 
> covar <- covariance(heather$coarse)
Warning message:
 the images 'setcovXi' and 'setcovB' were not compatible 
> p <- area(heather$coarse)/area(Frame(heather$coarse))
> sidelengths <- 2.2
> lac <- lac(sidelengths,covar,p)
> lac$MVL
[1] 0.06551107
> 
> #compare to calculation from spatstat's setcov:
> abs(lac$MVL - mvlc(list(square(2.2)),covar,p) ) < 0.01
[1] TRUE
> 
> #' #Test on a Boolean Model #takes a few minutes
> lambda <- 4*2.2064E-3
> discr <- 5
> w <- owin(xrange=c(0,100)*2,yrange=c(0,100)*2)
> xi <- rbdd(lambda,discr,w)
> xiimg <- as.im(xi, W=w, eps=c(0.1,0.1), na.replace=0)
> #estimate lacunarity
> sidelengths <- seq(0.5,50,by=1)
> mvl.est <- mvlc(sidelengths,xiim=xiimg)
> #theoretical lacunarity very different because window is small **I think
> thcovariance <- bdd.covar(
+                  xrange=c(-10,10)*4,
+ 	    yrange=c(-10,10)*4,
+ 	    eps=c(0.1,0.1),lambda,discr)
> #the following makes sure there is a border of NA values so that mvlc knows when it is using something outside the image
> thcovariance[setminus.owin(Frame(thcovariance),erosion(Frame(thcovariance),0.1))] <- NA
> thcoverageprob <- bdd.coverageprob(lambda,discr)
> mvl.th <- mvlc(sidelengths,thcovariance,thcoverageprob)
> abs(max(eval.fv(mvl.est-mvl.th)))  < 0.05
[1] TRUE
> 
> proc.time()
   user  system elapsed 
 39.772   0.968  40.741 
