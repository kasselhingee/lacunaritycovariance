% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariance.R, R/covarianceEXT.R
\name{covariance}
\alias{covariance}
\title{Covariance estimates, also known as `two-point probabilities' for stationary RACS}
\usage{
covariance(xi, w = NULL, inclraw = FALSE)

covariance(xi, w = NULL, inclraw = FALSE)
}
\arguments{
\item{w}{The observation window in \code{owin} format. If itsn't included its taken to be the smallest rectangle enclosing \code{Xi}.}

\item{inclraw}{If TRUE the output will be two \code{im} objects one for the standard estimator and one raw estimate.}

\item{Xi}{An observation (in spatstat owin format or black and white \code{im} object) of the RACS of interest.}

\item{setCovBoundaryThresh}{to avoid instabilities of dividing by very small areas, any vector \eqn{v} set covariance of the boundary smaller than this threshold is given a covariance of NA}

\item{Xi}{An observed RACS in an \code{owin} object or black and white image (\code{im} format).}

\item{w}{The observation window in \code{owin} format. If itsn't included its taken to be the smallest rectangle enclosing \code{Xi}.}

\item{inclraw}{If TRUE the output will be two \code{im} objects one for the standard estimator and one raw estimate.}
}
\value{
\code{SpatStat} \code{im} objects containing the estimated covariances.

\code{SpatStat} \code{im} objects containing the estimated covariances.
}
\description{
These functions estimate the covariance of a stationary random closed set. 
The covariance is also known as the two-point coverage probability, and very closely related to the semivariogram.
 The covariance of a vector \eqn{v} is the probability of two points separated by a \eqn{v} being covered by \eqn{\Xi}.

Estimates covariance using the reduced sample method suggested by Molchanov ... and a raw uncorrected estimate if requested.
}
\details{
The reduced sample estimator is [1]
\eqn{ \hat{C}(v) = \frac{|\Xi \cap W \cap ((\Xi \cap W ) \oplus v)|}{|W \cap W\oplus v|}}
and the raw estimate (if requested) is
\eqn{\hat{\tilde{C}}(v) = \frac{|\Xi \cap W \cap ((\Xi \cap W ) \oplus v)|}{|W|}.}
\code{covariance} uses Fourier transforms to calculate set covariances (using \code{\link[spatstat]{setcov}} function). It is much faster (500 times faster in one comparison) than \code{covarianceMapEst_direct}.
Vectors with small set covariance of the window are eliminated (using \code{setCovBoundaryThresh} because they cause the covariance to be enormous)

The reduced sample estimator is [1]
\eqn{ \hat{C}(v) = \frac{|\Xi \cap W \cap ((\Xi \cap W ) \oplus v)|}{|W \cap W\oplus v|}}
and the raw estimate is
\eqn{\hat{\tilde{C}}(v) = \frac{|\Xi \cap W \cap ((\Xi \cap W ) \oplus v)|}{|W|}.}
}
\examples{
xi <- heather$coarse
covar <- covariance(xi,inclraw=FALSE)
data(balcattapark_coarse)
xi <- balcattapark_coarse$vegmask
w <- balcattapark_coarse$boundary
covar <- covariance(xi,w,inclraw=FALSE)
data(balcattapark_coarse)
xi <- balcattapark_coarse$vegmask
w <- balcattapark_coarse$boundary
covar <- covariance(xi,w,inclraw=FALSE)
plot(covar,clipwin=owin(xrange=c(-10,10),yrange=c(-10,10)),axes=TRUE)
}
\author{
{Kassel Hingee}
}
\references{
[1] Molchanov, I. (1997) Statistics of the Boolean Model for Practitioners and Mathematicians. John Wiley & Sons.

[1] Molchanov, I. (1997) Statistics of the Boolean Model for Practitioners and Mathematicians. John Wiley & Sons.
}
\keyword{nonparametric}
\keyword{spatial}

